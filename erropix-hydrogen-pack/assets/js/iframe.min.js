function HydrogenPack(e,t,n){var o=angular.element(document),a=angular.element("body"),i=angular.element("#ct-builder"),c=angular.element("#oxygen-resize-box"),r=hydrogen.get("domTreeVersion"),s=t.component.active,d=a.hasClass("ct_connection_active"),l={clipboard:"",canSaveReusable:!1,canSaveBlock:!1,canReadClipboard:!1,canWrapLink:!1,getComponentObject:w},p=["savePage","switchCodeBlockTabs"],u=["cut","moveUp","moveDown","rename","changeId","showConditions","duplicate","saveReusable","saveBlock","wrap","delete","editContent"],g=["ct_id","ct_parent","ct_content","source_id","nicename","selector","activeselector","oxy_builtin"],h=["href","url","target","globalConditionsResult","globalconditions","code-php","code-css","code-js","full_shortcode","wrapping_shortcode","embed_src","use-custom","custom-code","src","image_type","attachment_height","attachment_id","attachment_size","attachment_url","attachment_width","icon-id","icon-facebook","icon-instagram","icon-linkedin","icon-rss","icon-twitter","icon-youtube","icon_box_heading","icon_box_text","gallery_source","image_ids","acf_field","metabox_field","woo_product_id","menu_id","pricing_box_content","pricing_box_package_regular","pricing_box_package_subtitle","pricing_box_package_title","pricing_box_price_amount_currency","pricing_box_price_amount_decimal","pricing_box_price_amount_main","pricing_box_price_amount_term","progress_bar_left_text","progress_bar_progress","progress_bar_progress-unit","progress_bar_right_text","testimonial_author","testimonial_author_info","testimonial_photo","testimonial_text","toggle_target","close_automatically","close_modal_on_backdrop_click","close_on_esc","number_of_clicks","open_again","trigger","map_address","map_zoom","soundcloud_auto_play","soundcloud_hide_related","soundcloud_track_id","soundcloud_url"];function b(e){return parent.angular.element(e)}function m(e){try{var t=JSON.stringify(e,(function(e,t){if("string"!=typeof e||0!==e.indexOf("$$"))return t}));return btoa(unescape(encodeURIComponent(t)))}catch(e){console.error(e)}return""}function f(e){try{var t=decodeURIComponent(escape(atob(e)));return JSON.parse(t)}catch(e){console.error(e)}return!1}function y(e){return!e.$$phase&&(e.$digest(),!0)}function v(e){setTimeout((function(){t.showNoticeModal("<div>"+e+"</div>"),y(t)}),100)}function k(){var e=t.getActiveComponent();e.length&&(e.addClass("hydrogen-flash"),setTimeout((function(){e.removeClass("hydrogen-flash")}),1100))}function C(){var e=[];return function t(n){n.forEach((function(n){n.id<1e5?e.push(n):n.children&&t(n.children)}))}(t.componentsTree.children),e}function w(e){var n=null;return function t(o){void 0!==o.id&&o.id==e?n=o:o.children&&o.children.forEach(t)}(t.componentsTree),n}function T(e){var n={};function o(e){var a=e.id;t.componentsClasses.hasOwnProperty(a)&&t.componentsClasses[a].forEach((function(e){n.hasOwnProperty(e)||t.classes.hasOwnProperty(e)&&(n[e]=t.classes[e])})),e.children&&e.children.forEach(o)}return e.constructor==Array?e.forEach(o):o(e),n}function x(e,n){var o={};function a(e){for(key in e)if(e.hasOwnProperty(key)){var n=e[key];if("string"==typeof n){var i=n.match(/color\((\d+)\)/);if(i){var c=i[1];if(o.hasOwnProperty(c))return;var r=t.getGlobalColor(c);r&&(o[c]=_.pick(r,"id","name","value"))}}"object"==typeof n&&a(n)}}return a(e),a(n),o}function S(e,n){for(key in"object"!=typeof t.styleFolders[n]&&(t.styleFolders[n]={status:1,key:n}),e)e[key].parent=n;t.classes=Object.assign(e,t.classes),t.classesCached=!1}function E(e,n,o,a){var i={},c=t.globalColorSets,r=_.findWhere(c.sets,{name:a});function s(e,t){return"color("+(i[t]||t)+")"}function d(e){_.each(e,(function(t,n){var o=/color\((\d*)\)/g;"string"==typeof t&&o.test(t)?e[n]=t.replace(o,s):"object"==typeof t&&d(e[n])}))}return"object"!=typeof r&&(r={id:++c.setsIncrement,name:a},c.sets.push(r)),_.each(e,(function(e){var t=_.findWhere(c.colors,{name:e.name,set:r.id});"object"!=typeof t&&(t={id:++c.colorsIncrement,name:e.name,value:e.value,set:r.id},c.colors.push(t)),i[e.id]=t.id})),d(n),d(o),i}function A(e){!function e(t){if("ct_image"==t.name){var n=t.options.original;if(n.attachment_url)for(var o in"2"==n.image_type&&(delete n.image_type,n.src=n.attachment_url),n)0==o.indexOf("attachment_")&&delete n[o]}t.children&&t.children.forEach(e)}(e)}function O(){return!n.isActiveActionTab("contentEditing")&&(s.id>1e5?-1:s.id>0||0)}function P(e,t){return 0==["ct_link","ct_link_button","ct_link_text","ct_widget","ct_shortcode","ct_code_block"].includes(e)&&"oxy_dynamic_list"!==t}function j(){var e=_.values(arguments),o=e.shift(),a=O();if(!1===a&&!p.includes(o))return!1;if(!0!==a&&u.includes(o))return!1;var i=!0,c=s.id,d=s.name,M=s.parent;switch(o){case"copy":if(i=!1,hydrogen.get("settings.clipboard.enabled")){var I=[];if(c>0&&c<1e5?I.push(w(c)):I=C(),I.length){var D=x(I,$=T(I));(B=m(H={source:hydrogen.get("siteUrl"),component:I,classes:$,colors:D}))&&(hydrogen.get("settings.clipboard.flashCopiedComponent")&&k(),R(B),i=B)}i||v("Can not copy the element to clipboard")}break;case"copyStyle":i=!1,hydrogen.get("settings.clipboard.enabled")&&((U=w(c))&&(D=x(J=angular.copy(U.options),$=T({id:c})),(X=_.omit(J,g)).original=_.omit(X.original,h),X.classes=X.classes||[],X.currentClass=t.currentClass,(B=m(H={source:hydrogen.get("siteUrl"),style:X,classes:$,colors:D}))&&(hydrogen.get("settings.clipboard.flashCopiedComponent")&&k(),R(B),i=B)),i||v("Can not copy style to clipboard"));break;case"copyConditions":if(i=!1,hydrogen.get("settings.clipboard.enabled"))if(U=w(c)){var L=hydrogen.get("options.original.globalconditions",null,U);if(L){var B,F=hydrogen.get("options.original.conditionstype","",U);(B=m(H={conditions:L,conditionstype:F}))&&(hydrogen.get("settings.clipboard.flashCopiedComponent")&&k(),R(B),i=B)}else v("There are no conditions to copy")}else v("Can not copy conditions to clipboard");break;case"cut":i=!1,hydrogen.get("settings.clipboard.enabled")&&j("copy")&&(t.removeComponentById(c,d,M.id),i=!0);break;case"paste":if(i=!1,hydrogen.get("settings.clipboard.enabled")){if(!l.clipboard)throw new Error("The clipboard is empty");var H;if((H=f(l.clipboard)).constructor!==Object)throw new Error("Invalid clipboard contents");if("object"==typeof H.component){var N=H.source,U=H.component;if(N&&N!==hydrogen.get("siteUrl")){hydrogen.get("settings.clipboard.processMediaImages")&&A(U);var z=hydrogen.get("settings.clipboard.colorSet","Copied Colors"),W=hydrogen.get("settings.clipboard.folder","Copied Classes"),$=H.classes;E(D=H.colors,U,$,z),S($,W)}var K={id:0,depth:0,name:"root",children:[]};Array.isArray(U)?K.children=U:K.children.push(U),n.showLoadingOverlay(),setTimeout((function(){t.addReusableChildren(K,null,c),n.hideLoadingOverlay(),hydrogen.get("settings.clipboard.keepActiveComponent")&&t.activateComponent(c,d)})),i=!0}if("object"==typeof H.style){if(!0!==a)throw new Error("Can not apply styles! The selected element is invalid");if(U=w(c)){N=H.source;var X,J=U.options,Y=(X=H.style).currentClass;N&&N!==hydrogen.get("siteUrl")&&(z=hydrogen.get("settings.clipboard.colorSet","Copied Colors"),W=hydrogen.get("settings.clipboard.folder","Copied Classes"),$=H.classes,E(D=H.colors,X,$,z),S($,W)),_.extend(X.original,_.pick(J.original,h)),_.extend(X,_.pick(J,g)),delete X.currentClass,U.options=X,t.component.options[c]=_.pick(t.component.options[c],g),t.componentsClasses[c]=X.classes;var q=c;"ct_span"==d&&(q=M.id),t.rebuildDOM(q),Y?t.setCurrentClass(Y):t.switchEditToId(!0),t.adjustResizeBox(),i=!0}}if("object"==typeof H.conditions){if(!0!==a)throw new Error("Can not apply conditions! The selected element is invalid");(U=w(c))&&(t.setOptionModel("globalconditions",H.conditions,c,d),t.setOptionModel("conditionstype",H.conditionstype,c,d),i=!0)}}break;case"moveUp":if((Z=w(M.id).children)&&Z.length>1){var G=0;if(Z.forEach((function(e,t){e.id==c&&(G=t)})),G>0){var V=Z[G];Z.splice(G,1),Z.splice(--G,0,V),t.rebuildDOM(M.id),"1"===r&&(t.updateDOMTreeNavigator(M.id),t.highlightDOMNode(c))}}break;case"moveDown":var Z;if((Z=w(M.id).children)&&Z.length>1){G=0;var Q=Z.length-1;Z.forEach((function(e,t){e.id==c&&(G=t)})),G<Q&&(V=Z[G],Z.splice(G,1),Z.splice(++G,0,V),t.rebuildDOM(M.id),"1"===r&&(t.updateDOMTreeNavigator(M.id),t.highlightDOMNode(c)))}break;case"rename":var ee=(J=t.component.options[c]).nicename||"";(ee=prompt("Enter the new element name",ee))?(ee=ee.replace(/["']+/g,"").trim())?(J.nicename=ee,t.updateFriendlyName(c)):v("Invalid name given!"):null!==ee&&v("Name can not be empty!");break;case"changeId":var te=(J=t.component.options[c]).selector||"";(te=prompt("Enter the new element id",te))?(te=te.replace(/[^\w\-_]+/g,"").trim())?(J.selector=te,t.setOption(c,d,"selector")):v("Invalid ID given!"):null!==te&&v("ID can not be empty!");break;case"showConditions":n.showConditionsMenu=!1,n.dialogForms.ifCondition=!0,n.showDialogWindow(),y(n);break;case"clearConditions":t.clearConditions();break;case"componentBrowser":n.switchActionTab("componentBrowser"),setTimeout((function(){n.resetComponentsSearch()}));break;case"addComponent":e.length&&t.addComponent.apply(null,e);break;case"switchAdvancedTab":e.length&&(n.showAllStylesFunc(),n.styleTabAdvance=!0,e.unshift("advanced"),n.switchTab.apply(null,e),y(n));break;case"switchCodeBlockTabs":i=!1,n.isActiveName("ct_code_block")&&(n.isShowTab("advanced","code-php")?n.switchTab("advanced","code-css"):n.isShowTab("advanced","code-css")?n.switchTab("advanced","code-js"):(n.isShowTab("advanced","code-js")||(n.showAllStylesFunc(),n.styleTabAdvance=!0),n.switchTab("advanced","code-php")),i=!0,y(n));break;case"applyCode":n.isShowTab("advanced","code-php")?t.applyCodeBlockPHP():n.isShowTab("advanced","code-css")?t.applyCodeBlockCSS():n.isShowTab("advanced","code-js")?t.applyCodeBlockJS():n.isShowTab("advanced","custom-js")?t.applyComponentJS():n.isShowTab("advanced","custom-css")?t.applyComponentCSS():i=!1;break;case"toggleLeftSidebar":var ne=n.showLeftSidebar;"boolean"==typeof ne&&(ne?n.doHideLeftSidebar(!0):n.doShowLeftSidebar(!0));break;case"toggleSettingsPanel":n.toggleSettingsPanel();break;case"switchTab":e.length&&n.switchTab.apply(null,e);break;case"switchSettingsTab":e.length&&(e.unshift("settings"),n.switchTab.apply(null,e),n.toggleSettingsPanel(!0));break;case"switchSettingsChildTab":e.length&&(e.unshift("settings"),n.tabs.settings=[],n.switchChildTab.apply(null,e),n.toggleSettingsPanel(!0));break;case"setMedia":if(e.length){var oe=e[0],ae=t.getCurrentMedia();if("number"==typeof oe){var ie=Object.keys(iframeScope.mediaList);if(!((G=ie.indexOf(ae)-oe)>=0&&G<ie.length))break;oe=ie[G]}else if(ae==oe)break;t.setCurrentMedia(oe,!0,t.isEditing("class"))}break;case"duplicate":t.duplicateComponent(c,d,M.id);break;case"saveReusable":t.saveReusable(c);break;case"saveBlock":t.saveReusable(c,!0);break;case"wrap":t.wrapComponentWith("ct_div_block",c,M.id);break;case"wrapLink":i=!1,P(d,M.name)&&(t.wrapComponentWith("ct_link",c,M.id),i=!0);break;case"delete":t.removeComponentWithUndo(c,d,M.id);break;case"activateParent":"number"==typeof M.id&&(M.id>1e5&&(M.id=0,M.name="root"),t.activateComponent(M.id,M.name));break;case"editContent":i=!1;var ce=t.getActiveComponent();ce&&ce.get(0).hasAttribute("contenteditable")&&(n.enableContentEdit(ce),i=!0);break;case"switchTextComponent":"ct_text_block"!=d&&"oxy_rich_text"!=d||(d="ct_text_block"==d?"oxy_rich_text":"ct_text_block",s.name=d,(U=w(c)).name=d,t.rebuildDOM(c),t.updateBreadcrumbs(c));break;case"undo":t.canUndo&&t.undo();break;case"redo":t.canRedo&&t.redo();break;case"savePage":j("applyCode"),t.savePage();break;case"openBackend":(re=b("#oxygen-topbar .oxygen-back-to-wp-menu a").first().prop("href"))&&window.open(re,"_blank");break;case"openFrontend":var re;G=t.ajaxVar.ctTemplate?2:1,(re=b("#oxygen-topbar .oxygen-back-to-wp-menu a").eq(G).prop("href"))&&window.open(re,"_blank");break;default:i=!1}return y(t),i}if(t.hydroScope=l,n.hydroScope=l,hydrogen.get("settings.contextMenu.enabled")){var M=e.children("#hydrogen-contextual-menu"),I=M.children("[data-command]"),D=null;function L(){D=null,M.hide(),M.css("left",0),M.css("top",0)}function B(e,n,o,a){if(O()){!function(){var e=s.id,n=s.name,o=s.parent,a=w(e),i=hydrogen.get("options.original.globalconditions",null,a);l.hasConditions=i&&i.length>0,l.canSaveReusable=t.isCanComponentize(e,n),l.canSaveBlock=d&&["ct_section","ct_div_block"].includes(n),l.canWrapLink=P(n,o.name),l.isTextComponent=["ct_text_block","oxy_rich_text"].includes(n),l.isTextComponent?l.convertTextLabel="ct_text_block"==n?"rich text":"text block":l.convertTextLabel="",l.canReadClipboard&&navigator.clipboard.readText().then((function(e){e&&/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/.test(e)&&(l.clipboard=e,y(t))})),y(t)}(),M.show();var i=document.documentElement.clientWidth,c=document.documentElement.clientHeight;(o=o||0)<i&&(o=0),(a=a||0)<c&&(a=0);var r=M.width(),p=M.height(),u=o+window.scrollX+i-r-2,g=a+window.scrollY+c-p-2;return M.css("left",Math.min(e,u)),M.css("top",Math.min(n,g)),D=s.id,!0}return!1}M.on("click mousedown mouseup touchstart",!1),o.on("click",L),o.on("contextmenu",(function(e){if(e.pageX>=0&&e.pageY>=0)L();else if(O()){var o=t.rbTitleBar.offset();if(o){var a=o.left+1,i=o.top+1,c=t.getActiveComponent();return n.scrollToComponent(c.attr("id")),B(a,i,o.left,o.top),!1}}})),i.on("contextmenu",(function(e){if(B(e.pageX+1,e.pageY+1))return!1})),c.on("contextmenu",(function(e){if(B(e.pageX+1,e.pageY+1))return!1})),I.on("click",(function(){var e=this.dataset.command;!this.classList.contains("disabled")&&e&&(setTimeout((function(){try{j(e)}catch(e){console.error(e),v("Failed to execute the command<br/>"+e)}}),10),L())})),t.$watch("component.active.id",(function(){D&&D!=s.id&&L()}))}if(hydrogen.get("settings.clipboard.enabled")){function R(e){if(e){l.clipboard=e;var t=document.getElementById("hydrogen-clipboard-input");return t.value=e,t.focus(),t.select(),document.execCommand("copy"),setTimeout((function(){t.value="",t.setSelectionRange(0,0),t.blur()})),!0}return!1}function F(e){if(!1!==O()){try{l.clipboard=e.originalEvent.clipboardData.getData("Text").trim(),j("paste")}catch(e){console.error(e),v("Failed to process the clipboard contents<br/>"+e)}e.stopPropagation(),e.preventDefault()}}navigator.permissions&&navigator.clipboard&&navigator.permissions.query({name:"clipboard-read"}).then((function(e){e.onchange=function(){l.canReadClipboard="denied"!==this.state},e.onchange()})).catch((function(){console.warn("Clipboard API is not supported in this browser")})),i.on("paste","[contenteditable]",(function(e){this.isContentEditable||(e.stopImmediatePropagation(),F(e))})),a.on("paste",F),l.pasteHandler=F}if(hydrogen.get("settings.shortcuts.enabled")){var H=[];function N(e){var t=[];return e.key&&(e.ctrl&&t.push("ctrl"),e.alt&&t.push("alt"),e.shift&&t.push("shift"),t.push(e.key.toLowerCase())),t.join("+")}function U(e){var t=!1;if(0==e.originalEvent.repeat){var o=N({ctrl:e.ctrlKey||e.metaKey,alt:e.altKey,shift:e.shiftKey,key:e.key});if(o){var a=_.findWhere(H,{shortcut:o});a&&a.arguments.length>0&&function(e,t){if(0==p.includes(t)){var o=e.target;if(o&&(o.isContentEditable||["INPUT","TEXTAREA"].includes(o.nodeName)))return!1;if(n.isActiveActionTab("contentEditing"))return!1}return!0}(e,a.arguments[0])&&(t=j.apply(this,a.arguments))}}t&&(e.stopImmediatePropagation(),e.preventDefault())}!function(){var e=hydrogen.get("settings.shortcuts.hotkeys");if("object"==typeof e){var t=!1,n=["arrowleft","arrowright"];_.each(e,(function(e,o){e.key&&e.arguments&&(H.push({id:o,shortcut:N(e),arguments:_.values(e.arguments)}),0==t&&n.includes(e.key)&&(t=!0))})),t&&a.on("keyup",(function(e){if(37==e.which||39==e.which)return!1}))}}(),function(){if(hydrogen.get("oxygenVersion")>="3.9.9"){var e=angular.element._data(document.body),t=hydrogen.get("events.keydown",null,e);t&&t.length>0&&t.forEach((function(e){"function"==typeof e.handler&&(angular.element("body").off("keydown",e.handler),parent.angular.element("body").off("keydown",e.handler))}))}}(),a.on("keydown",U),l.shortcutHandler=U}hydrogen.get("settings.disableEditLocking.enabled")&&(t.setPostEditLockTransient=function(){}),hydrogen.get("settings.conditionsEnhancer.enabled")&&(t.clearConditions=function(){var e=s.id,o=s.name;t.setOptionModel("conditionstype",void 0,e,o,!0),t.setOptionModel("globalconditions",void 0,e,o,!0),n.evalGlobalConditions(),n.evalGlobalConditionsInList()}),hydrogen.get("settings.advancedStylesReset.enabled")&&(jQuery.extend(!0,t.optionsHierarchy,{background:{gradient:["gradient"]},"background-gradient":{gradient:["gradient"]},"custom-css":{"custom-css":["custom-css"]},"custom-js":{"custom-js":["custom-js"]}}),t.clearTabOptions=function(e,n){e.stopPropagation(),e.preventDefault();var o=t.component.active.id,a=t.component.active.name,i=t.component.options,c=t.optionsHierarchy[n];"object"==typeof c&&_.each(c,(function(e){_.each(e,(function(e){i[o]&&i[o].model[e]&&(t.setOptionModel(e,void 0,o,a),!t.isEditing("id")||t.isEditing("media")||t.isEditing("state")||(i[o].id[e]=void 0))}))}))}),hydrogen.get("settings.dynamicClasses.enabled")&&(t.optionsHierarchy&&(t.optionsHierarchy["dynamic-classes"]={"dynamic-classes":["dynamic-classes"]}),t.addDynamicClass=function(){var e="dynamic-classes",n=t.getOption(e);Array.isArray(n)||(n=[]),n.push({value:"",notes:"",sanitize:!1}),t.setOptionModel(e,n)},t.removeDynamicClass=function(e,n){var o="dynamic-classes",a=t.getOption(o);a.splice(n,1),t.setOptionModel(o,a)},t.insertShortcodeToDynamicClass=function(e,n){dynamicClass="dyndata_"+btoa(unescape(encodeURIComponent(e))),t.setOptionModel(n,dynamicClass)}),hydrogen.get("settings.classLock.enabled")&&(t.isClassLocked=function(e){return(e=e||t.currentClass)&&hydrogen.get(e+".locked",!1,t.classes)},t.lockClass=function(e,n){t.classes[e].locked=!0,e==t.currentClass&&t.switchEditToId(!0),n.stopPropagation()},t.unlockClass=function(e,n){t.classes[e].locked=!1,n.stopPropagation()}),hydrogen.get("settings.preserveAdvancedTabs.enabled")&&function(){var e=hydrogen.get("settings.preserveAdvancedTabs.requireAltKey"),o=t.activateComponent;t.activateComponent=function(t,a,i){var c=s.id===t;"ct_inner_content"==a&&(n.styleTabAdvance=!0),n.saveAdvancedTabState(),o.call(null,t,a,i),t>0&&(c||!e||i&&i.altKey?n.restoreAdvancedTabState():n.clearAdvancedTabState())};var a=t.setCustomSelectorToEdit;t.setCustomSelectorToEdit=function(e){a.call(null,e),e&&(n.styleTabAdvance=!0)}}()}"object"!=typeof hydrogen&&(hydrogen={}),angular.extend(hydrogen,{get:function(e,t,n){var o;return n=n||this,void 0===(o=e.split(".").filter((function(e){return e})).reduce((function(e,t){return e&&e[t]}),n))&&(o=t),o},onFunction:function(e,t,n){var o=setInterval((function(){"function"==typeof e[t]&&(n.call(),clearInterval(o))}),50)}}),CTFrontendBuilder.directive("hydrogenPack",["$parentScope",function(e){return{restrict:"A",link:function(t,n){window.HydrogenPack=new HydrogenPack(n,t,e)}}}]),hydrogen.get("settings.classLock.enabled")&&CTFrontendBuilder.directive("oxygenResizeBox",["$compile",function(e){return{restrict:"AE",template:function(e){e.append("<div ng-class=\"{'oxygen-resize-box-class-locked': isClassLocked()}\"></div>")}}}]);